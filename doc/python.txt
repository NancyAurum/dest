Accessing Interpreter
___________________________

Use the "Window -> Python" menu and discover the flat API using “dir()”:

The function arguments are at:
https://github.com/NationalSecurityAgency/ghidra/blob/master/Ghidra/Features/Base/src/main/java/ghidra/program/flatapi/FlatProgramAPI.java



To lsit the FlatProgramAPI methods:
from ghidra.program.flatapi import FlatProgramAPI
for x in dir(FlatProgramAPI(getState().getCurrentProgram())): print(x)

Apparently it is also possible to do to list arguments:
  from ghidra.program.flatapi import FlatProgramAPI
  fpapi = FlatProgramAPI(getState().getCurrentProgram())
  for x in dir(fpapi): print(getattr(fpapi, x))


Advanced Python scripting to solve a difficult task:
https://dinohacks.com/posts/2024/2024-06-21-dealing-with-api-hashing-using-qiling/


Extended Python support
___________________________

There is also an extended Python support
https://pypi.org/project/pyhidra/

Another solution:
https://pypi.org/project/ghidra-bridge/


Ghidra supplied scripts
___________________________
* Data/ImportSymbolsScript.py (Ghidra/Features/Python/ghidra_scripts)
  It has format:

    NAME SEGMENT:OFFSET TYPE
  
  where type can be 'l' (label) or 'f' (function)
  'l' is default and can be omitted
  
  see sym/int21.txt for an example of DOS syscall map.

  
  
Snippets
___________________________
A collection of example snippets:
https://github.com/HackOvert/GhidraSnippets



#Example of using FlatProgramAPI
from ghidra.program.flatapi import FlatProgramAPI

state = getState()
program = state.getCurrentProgram()
fpapi = FlatProgramAPI(program)

for x in dir(fpapi): print(x)

print(fpapi.currentProgram)
print(fpapi.firstFunction)



FlatProgramAPI:

    from ghidra.program.flatapi import FlatProgramAPI

    state = getState()
    program = state.getCurrentProgram()
    fpapi = FlatProgramAPI(program)

    for x in dir(fpapi): print(x)

    print(fpapi.currentProgram)
    print(fpapi.firstFunction)


FlatDecompilerAPI:

    from ghidra.app.decompiler.flatapi import FlatDecompilerAPI
    from ghidra.program.flatapi import FlatProgramAPI

    fpapi = FlatProgramAPI(getState().getCurrentProgram())
    fdapi = FlatDecompilerAPI(fpapi)

    for x in dir(fdapi): print(x)

    main_decomp = fdapi.decompile(fpapi.getFunction('main'))
    print(main_decomp)

